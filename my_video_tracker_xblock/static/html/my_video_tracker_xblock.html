<div class="video-engagement-xblock">
    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Video Player</h2>
    <video id="xblockVideo" controls class="w-full h-auto rounded-xl shadow-md bg-black"
           src="{video_url}"
           poster="https://placehold.co/640x360/E0E7FF/3F51B5?text=Loading+Video..."
           oncontextmenu="return false;" preload="auto">
        Your browser does not support the video tag.
    </video>
    <div class="flex justify-center space-x-4 mt-4">
        <button id="xblockPlayVideoBtn" class="control-button">Play Video</button>
        <button id="xblockPauseVideoBtn" class="control-button-red">Pause Video</button>
    </div>

    <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-8">Webcam & Face Detection</h2>
    <div class="relative w-full aspect-video rounded-xl shadow-md bg-gray-900 flex items-center justify-center overflow-hidden">
        <video id="xblockWebcamVideo" autoplay muted class="absolute top-0 left-0 w-full h-full object-cover"></video>
        <canvas id="xblockFaceDetectionCanvas" class="absolute top-0 left-0 w-full h-full"></canvas>
        <div id="xblockWebcamStatus" class="absolute text-white text-lg font-medium">Loading webcam...</div>
    </div>
    <div class="flex justify-center space-x-4 mt-4">
        <button id="xblockStartWebcamBtn" class="control-button">Start Webcam</button>
        <button id="xblockStopWebcamBtn" class="control-button-red">Stop Webcam</button>
    </div>
    <p id="xblockModelLoadStatus" class="text-center text-sm text-gray-600 mt-2">Loading face detection models...</p>

    <h2 class="text-2xl font-semibold text-gray-700 mb-4 mt-8">Tracking Status</h2>
    <div class="status-box">
        <p><strong>Video Playing:</strong> <span id="xblockVideoPlayingStatus">No</span></p>
        <p><strong>Current Video Time:</strong> <span id="xblockVideoTimeStatus">0:00</span></p>
        <p><strong>Tab Active:</strong> <span id="xblockTabActiveStatus">Yes</span></p>
        <p><strong>Face Detected:</strong> <span id="xblockFaceDetectedStatus">No</span></p>
        <p class="mt-2"><em>(Data is sent to XBlock backend.)</em></p>
    </div>
</div>

<!-- Tailwind CSS (if not already loaded by Open edX) -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Inter font (if not already loaded by Open edX) -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<!-- face-api.js CDN for client-side face detection -->
<script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
